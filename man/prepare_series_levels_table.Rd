% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare_structure.R
\name{prepare_series_levels_table}
\alias{prepare_series_levels_table}
\title{Prepare ECB series levels metadata}
\usage{
prepare_series_levels_table(series_key, con, schema = "platform")
}
\arguments{
\item{series_key}{Character. An ECB series key (e.g., "ICP.M.U2.N.000000.4.ANR").}

\item{con}{Database connection object.}

\item{schema}{Character. The database schema name. Default is "platform".}
}
\value{
A data frame with columns \code{series_id}, \code{tab_dim_id}, and
  \code{level_value}. Returns \code{NULL} if the series doesn't exist in the
  database yet.
}
\description{
Prepares series level mappings for insertion into the database. Maps each
dimension value from the series key to its corresponding table dimension ID.
}
\details{
The function extracts dimension values from the series key and matches them
with table dimension IDs from the database. The frequency dimension (FREQ)
is moved from the first position to the last position to match the database
table_dimensions order.

For example, key "ICP.M.U2.N.000000.4.ANR" with dimensions:
FREQ=M, REF_AREA=U2, ADJUSTMENT=N, ICP_ITEM=000000, STS_INSTITUTION=4, ICP_SUFFIX=ANR

Is reordered to match table_dimensions:
REF_AREA=U2, ADJUSTMENT=N, ICP_ITEM=000000, STS_INSTITUTION=4, ICP_SUFFIX=ANR, FREQ=M
}
\examples{
\dontrun{
con <- DBI::dbConnect(...)

series_levels <- prepare_series_levels_table(
  series_key = "ICP.M.U2.N.000000.4.ANR",
  con = con
)
}

}
\seealso{
\code{\link{prepare_series_table}}
}
